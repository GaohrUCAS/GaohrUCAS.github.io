<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!--> <html lang="zh" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../../css/bootstrap.min-2.3.1.css">
	<link rel="stylesheet" type="text/css" href="../../../css/bootstrap-responsive.min.css">
	<link rel="stylesheet" type="text/css" href="../../../css/bootstrap-style.css">
    <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="../../../css/menu.css">
	<link rel="stylesheet" type="text/css" href="../../../css/blog.css">
    <link rel="stylesheet" type="text/css" href="../../../css/style.css">
	<link rel='stylesheet' type='text/css' href='../../../css/shCoreRDark.css'/>
	<link rel="shortcut icon" href="../../../img/logo.ico" />
    <title>GaoHR | 利用Matplotlib实现数据动态可视化</title>
	<style>
		.icon-download:before {display: inline;}
	</style>
</head>

<body>
	<!--head-->
	<div class="mainlogo">
		<a href="../../../index.html"><span class="g-left">G</span>aoHR</a>
		<img src="../../../img/head.png" class="headimg">
		<p><img src="../../../img/welcome.png" class="welcome"></p>
		<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
		<div class="weather" id ="weather"></div>
	</div>
	<div class="container-fluid main-page">
		<div class="row-fluid">
			<div class="span2">
				<!--responsive menu-->
				<div id="mainmenu"></div>
			</div>
			<div class="span8">
				<!--breadcrumb-->
				<ol class="breadcrumb">
					<li><a href="../../../index.html"><i class="icon-home"></i> Home</a></li>
					<i class="icon-angle-right"></i>
					<a href="../../../Blogs.html"> Blog</a>
					<!--<li class="active">Blog</li>-->
				</ol>
				<!--正文-->
				<input id="blogid" style="display:none" value="2019100801">
				<div class="blogcontent alist">
					<h2>利用Matplotlib实现数据动态可视化</h2>
					<h2><small>Data dynamic visualization by using Matplotlib</small></h2>
					<div class="blogtopinfo"><span id="blogtopinfo"></span></div>
					<p><b><li>摘要</li></b></p>
					<p style="font-family:'楷体'" class="g-color-blue">以1850-2018年全球平均气温距基准平均气温（1961-1990年）的变化数据为例，基于Matplotlib python库绘制数据可动态视化图。</p>
					<p>制作结果预览：</p>
					<p class="imginblog"><img src="2019-10-08-dynamic-plot-matplotlib\img001.gif"></p>
					<p>下载原视频：<a class="btn-red" href="2019-10-08-dynamic-plot-matplotlib\climate_msc.mp4" target="_blank"><i class="icon-download"></i></a></p>
					<p><b><li>Matplotlib简单介绍</li></b></p>
					<p>Matplotlib是Python中功能全面的绘图库。同时，它也可以与数学运算库NumPy、图形工具包PyQt和wxPython等多种python库一起使用，提供了一种有效的MatLab开源替代方案。</p>
					<p>开发者使用Matplotlib，可以仅需要少量的代码，便可制作出专业、美观的直方图，条形图，功率谱，散点图等多种类型的图，是实现数据可视化的简单高效的工具。</p>
					<p class="g-color-blue">对于Matplotlib的安装、基本使用等，本文不再过多的介绍，在此附上官网链接，足够学习使用~</p>
					<p>* 官方主页：<a href="https://matplotlib.org" target="_blank">https://matplotlib.org</a></p>
					<p>* 官方示例：<a href="https://matplotlib.org/gallery/index.html" target="_blank">https://matplotlib.org/gallery/index.html</a></p>
					<p>* 官方API：<a href="https://matplotlib.org/api/index.html" target="_blank">https://matplotlib.org/api/index.html</a></p>
					<p class="imginblog"><img src="2019-10-08-dynamic-plot-matplotlib\img001.jpg"></p>
					<p><b><li>绘制动态图</li></b></p>
					<p>一般情况下，利用Matplotlib绘制动态图时，通常选择使用Matplotlib的<code>animation</code>模块，但是该模块的函数使用比较繁琐，不易学习，开发不灵活。</p>
					<p class="g-color-red">因此，本文介绍一种相对比较简单的办法，使用动态绘图和暂停功能来实现，具体看代码。</p>
					<div id="highlighter_220865" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#&nbsp;-*-&nbsp;coding:&nbsp;utf-8&nbsp;-*-</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">numpy</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">matplotlib.pyplot&nbsp;as&nbsp;plt</code></div><div class="line number5 index4 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">matplotlib.dates&nbsp;as&nbsp;mdate</code></div><div class="line number6 index5 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">util&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">ReadDatafromExcel,&nbsp;GetDateArr</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python comments">#&nbsp;配置参数</code></div><div class="line number9 index8 alt2"><code class="python plain">plt.rcParams[</code><code class="python string">'font.family'</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'Times&nbsp;New&nbsp;Roman'</code>&nbsp;&nbsp;<code class="python comments">#&nbsp;设置字体</code></div><div class="line number10 index9 alt1"><code class="python plain">plt.rcParams[</code><code class="python string">'axes.unicode_minus'</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">False</code>&nbsp;&nbsp;<code class="python comments">#&nbsp;用来正常显示负号</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python comments">#&nbsp;设置字体大小</code></div><div class="line number13 index12 alt2"><code class="python plain">fs_label&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">18</code></div><div class="line number14 index13 alt1"><code class="python plain">fs_ticks&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">16</code></div><div class="line number15 index14 alt2"><code class="python plain">fs_legend&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">16</code></div><div class="line number16 index15 alt1"><code class="python plain">fs_text&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">16</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">Plot(x,&nbsp;y1,&nbsp;y2):</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Create&nbsp;plot</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;x:</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;y1:</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;y2:</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fig,&nbsp;ax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">plt.subplots(figsize</code><code class="python keyword">=</code><code class="python plain">(</code><code class="python value">14</code><code class="python plain">,&nbsp;</code><code class="python value">5</code><code class="python plain">))&nbsp;&nbsp;</code><code class="python comments">#&nbsp;创建窗口和子图</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.tick_params(labelsize</code><code class="python keyword">=</code><code class="python plain">fs_ticks)&nbsp;&nbsp;</code><code class="python comments">#&nbsp;设置刻度字体</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;设置时间轴格式</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fig.autofmt_xdate(rotation</code><code class="python keyword">=</code><code class="python value">30</code><code class="python plain">,&nbsp;ha</code><code class="python keyword">=</code><code class="python string">'center'</code><code class="python plain">)</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dateFmt&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">mdate.DateFormatter(</code><code class="python string">'%Y'</code><code class="python plain">)</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.xaxis.set_major_formatter(dateFmt)</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">years&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.arange(</code><code class="python functions">int</code><code class="python plain">(x[</code><code class="python value">0</code><code class="python plain">]),&nbsp;</code><code class="python functions">int</code><code class="python plain">(x[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">])&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">1</code><code class="python plain">)</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">yearsDate&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">GetDateArr(years)&nbsp;&nbsp;</code><code class="python comments">#&nbsp;获取年份列表</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">xs&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[yearsDate[</code><code class="python value">0</code><code class="python plain">],&nbsp;yearsDate[</code><code class="python value">0</code><code class="python plain">]]</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[y1[</code><code class="python value">0</code><code class="python plain">],&nbsp;y1[</code><code class="python value">0</code><code class="python plain">]]</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[y2[</code><code class="python value">0</code><code class="python plain">],&nbsp;y2[</code><code class="python value">0</code><code class="python plain">]]</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;添加text</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(yearsDate[</code><code class="python keyword">-</code><code class="python value">22</code><code class="python plain">],&nbsp;</code><code class="python keyword">-</code><code class="python value">0.7</code><code class="python plain">,&nbsp;</code><code class="python string">'Made&nbsp;by&nbsp;GaoHR'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python plain">fs_text</code><code class="python keyword">-</code><code class="python value">2</code><code class="python plain">,&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#1E90FF'</code><code class="python plain">)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(yearsDate[</code><code class="python value">0</code><code class="python plain">],&nbsp;</code><code class="python keyword">-</code><code class="python value">0.7</code><code class="python plain">,&nbsp;</code><code class="python string">'Global&nbsp;temperature&nbsp;anomaly&nbsp;datasets&nbsp;(<a href="http://www.cru.uea.ac.uk/cru/data/temperature/">http://www.cru.uea.ac.uk/cru/data/temperature/</a>)'</code><code class="python plain">,</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fontsize</code><code class="python keyword">=</code><code class="python plain">fs_text</code><code class="python keyword">-</code><code class="python value">2</code><code class="python plain">,&nbsp;fontfamily</code><code class="python keyword">=</code><code class="python string">'Times&nbsp;New&nbsp;Roman'</code><code class="python plain">,&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#333333'</code><code class="python plain">)</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(yearsDate[</code><code class="python value">0</code><code class="python plain">],&nbsp;</code><code class="python value">0.5</code><code class="python plain">,&nbsp;</code><code class="python string">'The&nbsp;global&nbsp;record&nbsp;data&nbsp;were&nbsp;provided&nbsp;by&nbsp;Climatic&nbsp;Research&nbsp;Unit'</code><code class="python plain">,</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fontsize</code><code class="python keyword">=</code><code class="python plain">fs_text</code><code class="python keyword">-</code><code class="python value">2</code><code class="python plain">,&nbsp;fontfamily</code><code class="python keyword">=</code><code class="python string">'Times&nbsp;New&nbsp;Roman'</code><code class="python plain">,&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#333333'</code><code class="python plain">)</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(yearsDate[</code><code class="python value">0</code><code class="python plain">],&nbsp;</code><code class="python value">0.15</code><code class="python plain">,&nbsp;</code><code class="python string">'The&nbsp;time&nbsp;series&nbsp;shows&nbsp;the&nbsp;combined&nbsp;global&nbsp;land&nbsp;and&nbsp;marine&nbsp;surface&nbsp;temperature&nbsp;record\n'</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'from&nbsp;1850&nbsp;to&nbsp;2018.&nbsp;The&nbsp;base&nbsp;period&nbsp;is&nbsp;1961-1990.\n'</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'This&nbsp;year&nbsp;was&nbsp;the&nbsp;4rd&nbsp;warmest&nbsp;on&nbsp;record.'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python plain">fs_text</code><code class="python keyword">-</code><code class="python value">4</code><code class="python plain">,&nbsp;fontfamily</code><code class="python keyword">=</code><code class="python string">'Times&nbsp;New&nbsp;Roman'</code><code class="python plain">,&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#666666'</code><code class="python plain">)</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;设置x、y轴范围</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;plt.xlim(x_min,&nbsp;x_max)</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.ylim(</code><code class="python keyword">-</code><code class="python value">0.75</code><code class="python plain">,&nbsp;</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;设置标签、添加刻度标线</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.set_xlabel(</code><code class="python string">'Year'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python plain">fs_label,&nbsp;fontfamily</code><code class="python keyword">=</code><code class="python string">'Times&nbsp;New&nbsp;Roman'</code><code class="python plain">)</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.set_ylabel(</code><code class="python string">'Temperature&nbsp;anomaly&nbsp;($^o$C)'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python plain">fs_label,&nbsp;fontfamily</code><code class="python keyword">=</code><code class="python string">'Times&nbsp;New&nbsp;Roman'</code><code class="python plain">)</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.grid(</code><code class="python color1">True</code><code class="python plain">,&nbsp;linestyle</code><code class="python keyword">=</code><code class="python string">'--'</code><code class="python plain">,&nbsp;alpha</code><code class="python keyword">=</code><code class="python value">0.5</code><code class="python plain">)</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;动态读取数据，绘制图形</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(years[</code><code class="python value">0</code><code class="python plain">],&nbsp;years[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]):</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;更新x,&nbsp;y1,&nbsp;y2</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">xs[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">xs[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ys[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys2[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ys2[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">xs[</code><code class="python value">1</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">yearsDate[i&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python functions">int</code><code class="python plain">(x[</code><code class="python value">0</code><code class="python plain">])]</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys[</code><code class="python value">1</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">y1[i&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python functions">int</code><code class="python plain">(x[</code><code class="python value">0</code><code class="python plain">])]</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ys2[</code><code class="python value">1</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">y2[i&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python functions">int</code><code class="python plain">(x[</code><code class="python value">0</code><code class="python plain">])]</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.bar(xs,&nbsp;ys,&nbsp;width</code><code class="python keyword">=</code><code class="python value">150</code><code class="python plain">,&nbsp;color</code><code class="python keyword">=</code><code class="python plain">getColor(y1[i&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python functions">int</code><code class="python plain">(x[</code><code class="python value">0</code><code class="python plain">])]))&nbsp;&nbsp;</code><code class="python comments">#&nbsp;绘制条状图</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.plot(xs,&nbsp;ys2,&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#555555'</code><code class="python plain">)&nbsp;&nbsp;#&nbsp;绘制曲线图</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.legend([</code><code class="python string">'Smoothed'</code><code class="python plain">],&nbsp;loc</code><code class="python keyword">=</code><code class="python string">'upper&nbsp;left'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python plain">fs_legend)&nbsp;&nbsp;</code><code class="python comments">#&nbsp;添加图例</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.pause(</code><code class="python value">0.1</code><code class="python plain">)&nbsp;&nbsp;</code><code class="python comments">#&nbsp;设置时间间隔</code></div><div class="line number74 index73 alt1">&nbsp;</div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.tight_layout()</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.show()</code></div></div></td></tr></tbody></table></div>
					<p>还有用到的一些函数：读取Excel表格函数<code>ReadDatafromExcel</code>，不同值显示不同的颜色<code>getColor</code>等</p>
					<div id="highlighter_242142" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">ReadDatafromExcel(xlsfile,&nbsp;sheet_name,&nbsp;ytype,&nbsp;yindex,&nbsp;t_index</code><code class="python keyword">=</code><code class="python plain">[]):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Read&nbsp;data&nbsp;from&nbsp;excel</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;xlsfile:&nbsp;</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;sheet_name:&nbsp;</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;ytype:&nbsp;</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;yindex:&nbsp;</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;t_index:&nbsp;</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:&nbsp;2-D&nbsp;array</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">bk&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">xlrd.open_workbook(xlsfile)</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">sh&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">bk.sheets():</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;print&nbsp;len(sh.col_values(0))</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;print&nbsp;"Sheet:",&nbsp;sh.name</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">sh.name&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">sheet_name:</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;y&nbsp;=&nbsp;numpy.zeros((len(ytype),&nbsp;days_num))</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">j&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(ytype)):</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">k&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;col_len&nbsp;=&nbsp;len(filter(lambda&nbsp;x:&nbsp;x&nbsp;!=&nbsp;"",&nbsp;sh.col_values(j)))&nbsp;#&nbsp;获取列的长度</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">row_len&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">sh.nrows</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">j&nbsp;</code><code class="python keyword">not</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">t_index:</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(row_len&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">1</code><code class="python plain">):</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">k.append(sh.cell(i&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">1</code><code class="python plain">,&nbsp;yindex[j]).value)</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y.append(k)</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;如果是时间字段，则读取为&nbsp;datetime&nbsp;类型</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(row_len&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">1</code><code class="python plain">):</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">k.append(xlrd.xldate.xldate_as_datetime(sh.cell(i&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">1</code><code class="python plain">,&nbsp;yindex[j]).value,&nbsp;bk.datemode))</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y.append(k)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">y</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">getColor(t):</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Get&nbsp;color&nbsp;based&nbsp;on&nbsp;t</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">t&nbsp;&lt;&nbsp;</code><code class="python keyword">-</code><code class="python value">0.5</code><code class="python plain">:</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#191970"</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python keyword">-</code><code class="python value">0.5</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python keyword">-</code><code class="python value">0.4</code><code class="python plain">:</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#0000CD"</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python keyword">-</code><code class="python value">0.4</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python keyword">-</code><code class="python value">0.3</code><code class="python plain">:</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#0000FF"</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python keyword">-</code><code class="python value">0.3</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python keyword">-</code><code class="python value">0.1</code><code class="python plain">:</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#1E90FF"</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python keyword">-</code><code class="python value">0.1</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python value">0</code><code class="python plain">:</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#87CEEB"</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python value">0</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python value">0.1</code><code class="python plain">:</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#7FFFD4"</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python value">0.1</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python value">0.3</code><code class="python plain">:</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#FFD700"</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python value">0.3</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python value">0.4</code><code class="python plain">:</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#FF8C00"</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python value">0.4</code>&nbsp;<code class="python plain">&lt;&nbsp;t&nbsp;&lt;&nbsp;</code><code class="python value">0.5</code><code class="python plain">:</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#FF8C00"</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python string">"#FF4500"</code></div></div></td></tr></tbody></table></div>
					<p>主函数</p>
					<div id="highlighter_353918" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">if</code>&nbsp;<code class="python plain">__name__&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">"__main__"</code><code class="python plain">:</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">xlsfile&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r</code><code class="python string">"&lt;Excel文件路径&gt;"</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sheet_name&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"Sheet1"</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ytype&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[</code><code class="python string">"x"</code><code class="python plain">,&nbsp;</code><code class="python string">"&nbsp;y1"</code><code class="python plain">,&nbsp;</code><code class="python string">"y2"</code><code class="python plain">]</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">yindex&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[</code><code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">2</code><code class="python plain">]</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ReadDatafromExcel(xlsfile,&nbsp;sheet_name,&nbsp;ytype,&nbsp;yindex)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">y2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data[</code><code class="python value">2</code><code class="python plain">]</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">Plot(x,&nbsp;y1,&nbsp;y2)</code></div></div></td></tr></tbody></table></div>
					<p><b><li>补充</li></b></p>
					<p>需要注意的是，本文代码读取的Excel表格格式如下图所示。</p>
					<p>数据可以从<a href="http://www.cru.uea.ac.uk/cru/data/temperature/" target="_blank">Global temperature anomaly datasets</a>网站上获取。</p>
					<p class="imginblog"><img src="2019-10-08-dynamic-plot-matplotlib\img002.jpg"></p>
					<p>附绘制的数据静态图</p>
					<p class="imginblog"><img src="2019-10-08-dynamic-plot-matplotlib\climate.png"></p>
					<p></p>
					<p></p>
					<hr>
					<br>
					<p>Fighting, GISer!</p>
					<!-- Warning -->
					<div id="warning"></div>
				</div>
				<!-- Da shang -->
				<div id="dashang" class="dashang"></div>
				<!-- Comments -->
				<div id="comments"></div>
			</div>
			<div class="span2">
				<div class="block"></div>
				<div class="portlet" id="declareDiv"></div>
				<div class="block"></div>
				<div class="portlet">
					<p class="title"><i class="icon-book"></i><b>最新博文</b></p>
					<br>
					<div class="blog-page" id="blogs"></div>
				</div>
				<!-- Share -->
				<div id="shareit"></div>
			</div>
		</div>
	</div>
	<!-- others  --> 
	<div id="others"></div>
	<!-- footer  --> 
	<footer>
		<p id="copyright" class="copyright"></p>
	</footer>
    <!-- JavaScript -->
    <script src="../../../js/jquery.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
	<script src="../../../js/bloglist.js"></script>
	<script src="../../special/js/topicslist.js"></script>
	<script src="../../../js/paylist.js"></script>
	<script src="../blogsload.js"></script>
	<script src="../../../js/common.js"></script>
</body>
</html>
