<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!--> <html lang="zh" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../../../css/bootstrap.min-2.3.1.css">
	<link rel="stylesheet" type="text/css" href="../../../css/bootstrap-responsive.min.css">
	<link rel="stylesheet" type="text/css" href="../../../css/bootstrap-style.css">
    <link rel="stylesheet" type="text/css" href="../../../css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="../../../css/menu.css">
	<link rel="stylesheet" type="text/css" href="../../../css/blog.css">
    <link rel="stylesheet" type="text/css" href="../../../css/style.css">
	<link rel='stylesheet' type='text/css' href='../../../css/shCoreRDark.css'/>
	<link rel="shortcut icon" href="../../../img/logo.ico" />
    <title>GaoHR | 温度植被干旱指数（TVDI）的计算及其Python实现</title>
	<style>
		.bmath b {color:#00498a}
	</style>
</head>

<body>
	<!--head-->
	<div class="mainlogo">
		<a href="../../../index.html"><span class="g-left">G</span>aoHR</a>
		<img src="../../../img/head.png" class="headimg">
		<p><img src="../../../img/welcome.png" class="welcome"></p>
		<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
		<div class="weather" id ="weather"></div>
	</div>
	<div class="container-fluid main-page">
		<div class="row-fluid">
			<div class="span2">
				<!--responsive menu-->
				<div id="mainmenu"></div>
			</div>
			<div class="span8">
				<!--breadcrumb-->
				<ol class="breadcrumb">
					<li><a href="../../../index.html"><i class="icon-home"></i> Home</a></li>
					<i class="icon-angle-right"></i>
					<a href="../../../Blogs.html"> Blog</a>
					<!--<li class="active">Blog</li>-->
				</ol>
				<!--正文-->
				<input id="blogid" style="display:none" value="2017041401">
				<div class="blogcontent">
					<h2>温度植被干旱指数（TVDI）的计算及其Python实现</h2>
					<h2><small>Temperature Vegetation Dryness Index(TVDI) and implementation based on Python program</small></h2>
					<div class="blogtopinfo"><span id="blogtopinfo"></span></div>
					<p><b>温度植被干旱指数（Temperature Vegetation Dryness Index，TVDI）</b>是一种基于光学与热红外遥感通道数据进行植被覆盖区域表层土壤水分反演的方法。作为同时与归一化植被指数(NDVI)和地表温度(LST)相关的温度植被干旱指数(TVDI)可用于干旱监测，尤其是监测特定年内某一时期整个区域的相对干旱程度，并可用于研究干旱程度的空间变化特征。</p>
					<ul>
						<li><a href="#ca">（一） TVDI计算公式</a></li>
						<li><a href="#cb">（二） 干湿边拟合</a></li>
						<li><a href="#cc">（三） TVDI计算的Python实现</a></li>
					</ul>
					<p id="ca" style="font-size:1.2em"><b>（一） TVDI计算公式</b></p>
					<p>温度植被干旱指数的公式如下：</p>
					<p class="imginblog"><img src="2017-04-14-tvdi/eq_tvdi.png" style="width:45%"></p>
					<p>其中，湿边方程<pre>LSTsmin = a * NDVI + b</pre>
					<p>干边方程<pre>LSTsmax = c * NDVI + d</pre></p>
					<p>TVDI的值域为[0, 1]。</p>
					<p>TVDI的值越大，表示土壤湿度越低，TVDI越小，表示土壤湿度越高。</p>
					<p id="cb" style="font-size:1.2em"><b>（二） 干湿边拟合</b></p>
					<p>在TVDI指数计算的过程中，需要拟合干边方程和湿边方程，其中还需要用户自己设置参数，是比较重要的计算步骤。拟合的关键是怎么找到有效的NDVI（相当于自变量X）和LST（相当于因变量Y）这两组相对应的数据，本文针对干湿边的拟合过程做一下详细的说明。</p>
					<p>根据输入的NDVI和LST数据，以NDVI为横坐标，LST为纵坐标，可以得到NDVI-LST的散点图。根据NDVI-LST的散点图，就能得到每个NDVI值对应的LST的最大最小值，也就是我们要求的干边和湿边。具体步骤如下：</p>
					<p>1）将NDVI等分为100份，分别为0~0.01，0.01~0.02，，，，，0.99~1.0（可根据具体情况进行修改）；</p>
					<p>2）在NDVI影像中查找每个范围内的NDVI值的索引，然后根据这些索引获取对应的LST数据的栅格值，求出每个范围内LST栅格值中的最大值和最小值；</p>
					<p>3）将100份的LST栅格值分别求出最大值和最小值，就能得到NDVI-LST对应的干湿边的散点图，如下图所示；</p>
					<p>4）设置NDVI的有效值范围（通常为0.2~0.8），选取有效范围内的数值进行线性拟合，得到干湿边方程。</p>
					<p class="imginblog"><img src="2017-04-14-tvdi/dry_wet.jpg"></p>
					<p id="cc" style="font-size:1.2em"><b>（三） Python实现TVDI计算</b></p>
					<p>TVDI模型对干旱监测方面有重要的意义，但是目前的GIS和遥感软件中缺少计算TVDI的工具，要实现这个模型需要编程，做起来十分麻烦。有人利用ENVI/IDL来计算TVDI，开发出了TVDI计算补丁，但用起来很不灵活，有时还会出现未知错误，给用户造成很多困扰。</p>
					<p>因此，本博客基于Python语言实现了TVDI的计算，详细代码如下：</p>
					<p>导入必要的库</p>
					<div id="highlighter_424947" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">os</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">math</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">numpy</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">matplotlib.pyplot&nbsp;as&nbsp;plt</code></div><div class="line number5 index4 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">osgeo&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">gdal,osr</code></div></div></td></tr></tbody></table></div>
					<p>首先，定义读取栅格数据的类函数，依赖GDAL python库。关于GDAL python库的安装，本文不做细讲，如需要可自行搜索学习。</p>
					<div id="highlighter_41141" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">osgeo&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">gdal,osr</code></div><div class="line number2 index1 alt1"><code class="python keyword">class</code>&nbsp;<code class="python plain">Raster:</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">,&nbsp;nRows,&nbsp;nCols,&nbsp;data,&nbsp;noDataValue</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">,&nbsp;geotransform</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">,&nbsp;srs</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">):</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.nRows&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">nRows</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.nCols&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">nCols</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.noDataValue&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">noDataValue</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.geotrans&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.srs&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">srs</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.dx&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.xMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.xMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">nCols&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.yMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">3</code><code class="python plain">]</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.yMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">3</code><code class="python plain">]&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">nRows&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">geotransform[</code><code class="python value">5</code><code class="python plain">]</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">ReadRaster(rasterFile):</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">gdal.</code><code class="python functions">Open</code><code class="python plain">(rasterFile)</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">band&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ds.GetRasterBand(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">band.ReadAsArray()</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">xsize&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">band.XSize</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ysize&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">band.YSize</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">noDataValue&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">band.GetNoDataValue()</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">geotrans&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ds.GetGeoTransform()</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">osr.SpatialReference()</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs.ImportFromWkt(ds.GetProjection())</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;print&nbsp;srs.ExportToProj4()</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">noDataValue&nbsp;</code><code class="python keyword">is</code>&nbsp;<code class="python color1">None</code><code class="python plain">:</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">noDataValue&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">9999</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">Raster(ysize,&nbsp;xsize,&nbsp;data,&nbsp;noDataValue,&nbsp;geotrans,&nbsp;srs)</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">WriteGTiffFile(filename,&nbsp;nRows,&nbsp;nCols,&nbsp;data,&nbsp;geotransform,&nbsp;srs,&nbsp;noDataValue,&nbsp;gdalType):</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">format</code>&nbsp;<code class="python keyword">=</code>&nbsp;<code class="python string">"GTiff"</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">driver&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">gdal.GetDriverByName(</code><code class="python functions">format</code><code class="python plain">)</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">driver.Create(filename,&nbsp;nCols,&nbsp;nRows,&nbsp;</code><code class="python value">1</code><code class="python plain">,&nbsp;gdalType)</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds.SetGeoTransform(geotransform)</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds.SetProjection(srs.ExportToWkt())</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds.GetRasterBand(</code><code class="python value">1</code><code class="python plain">).SetNoDataValue(noDataValue)</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds.GetRasterBand(</code><code class="python value">1</code><code class="python plain">).WriteArray(data)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ds&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;</code>&nbsp;</div></div></td></tr></tbody></table></div>
					<p>编写主要的函数，包括干边、湿边提取拟合，以及计算TVDI</p>
					<div id="highlighter_219152" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">calTVDI(</code><code class="python functions">dir</code><code class="python plain">,&nbsp;in_ndvi_raster,&nbsp;in_lst_raster,&nbsp;ndvi_range,&nbsp;out_raster):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Calculate&nbsp;TVDI</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;读取输入栅格数据信息</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"读取输入栅格数据信息..."</code><code class="python plain">)</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">raster_ndvi&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ReadRaster(in_ndvi_raster)</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">raster_lst&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ReadRaster(in_lst_raster)</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndvi&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.data</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">lst&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_lst.data</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nc&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.nCols</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.nRows</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">geo&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.geotrans</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.srs</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndv_ndvi&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_ndvi.noDataValue</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndv_lst&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">raster_lst.noDataValue</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">abcd&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">edge(</code><code class="python functions">dir</code><code class="python plain">,&nbsp;ndvi,&nbsp;lst,&nbsp;nr,&nbsp;nc,&nbsp;ndv_ndvi,&nbsp;ndv_lst,&nbsp;ndvi_range)</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">a&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">c&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"\t干边拟合方程：y&nbsp;=&nbsp;%.3fx&nbsp;+&nbsp;%.3f，r2&nbsp;=&nbsp;%.3f"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(a,&nbsp;b,&nbsp;abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]))</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"\t湿边拟合方程：y&nbsp;=&nbsp;%.3fx&nbsp;+&nbsp;%.3f，r2&nbsp;=&nbsp;%.3f"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(c,&nbsp;d,&nbsp;abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]))</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tvdi&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.zeros((nr,&nbsp;nc))</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">m&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(nr):</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">n&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(nc):</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">ndvi[m][n]&nbsp;!</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndv_ndvi&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">lst[m][n]&nbsp;!</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndv_lst:</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tvdi[m][n]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(lst[m][n]&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">(abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">ndvi[m][n]&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]))&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">((abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">ndvi[m][n]&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">])&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">(abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">ndvi[m][n]&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]))</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tvdi[m][n]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndv_ndvi</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#Save&nbsp;TVDI</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">WriteGTiffFile(out_raster,&nbsp;nr,&nbsp;nc,&nbsp;tvdi,&nbsp;geo,&nbsp;srs,&nbsp;ndv_ndvi,&nbsp;gdal.GDT_Float32)</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"计算完成\n\tSave&nbsp;as&nbsp;'%s'\n"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">out_raster)</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">edge(</code><code class="python functions">dir</code><code class="python plain">,&nbsp;ndvi,&nbsp;lst,&nbsp;nr,&nbsp;nc,&nbsp;ndv_ndvi,&nbsp;ndv_lst,&nbsp;ndvi_range):</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Get&nbsp;dry&nbsp;edge&nbsp;and&nbsp;wet&nbsp;edge</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"干边、湿边拟合..."</code><code class="python plain">)</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">edgeArr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[[]&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">_&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">99</code><code class="python plain">)]</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(nr):</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">j&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(nc):</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">ndvi[i][j]&nbsp;!</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndv_ndvi&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">lst[i][j]&nbsp;!</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndv_lst:</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">ndvi[i][j]&nbsp;&gt;&nbsp;</code><code class="python value">0</code>&nbsp;<code class="python keyword">and</code>&nbsp;<code class="python plain">ndvi[i][j]&nbsp;&lt;&nbsp;</code><code class="python value">1</code><code class="python plain">:</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">k&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">str</code><code class="python plain">(ndvi[i][j])[</code><code class="python value">2</code><code class="python plain">:</code><code class="python value">4</code><code class="python plain">]</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">lst[i][j]&nbsp;&gt;&nbsp;</code><code class="python keyword">-</code><code class="python value">9999</code>&nbsp;<code class="python keyword">and</code>&nbsp;<code class="python plain">lst[i][j]&nbsp;&lt;&nbsp;</code><code class="python value">9999</code><code class="python plain">:</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">edgeArr[</code><code class="python functions">int</code><code class="python plain">(k)].append(lst[i][j])</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;排序，寻找干边湿边</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">eMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndviSort&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">eMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">n&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(edgeArr)):</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">edgeSort&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.sort(edgeArr[n])</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python functions">len</code><code class="python plain">(edgeSort)&nbsp;&gt;&nbsp;</code><code class="python value">1</code><code class="python plain">:</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">eMax.append(edgeSort[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">])</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">eMin.append(edgeSort[</code><code class="python value">0</code><code class="python plain">])</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndviSort.append(</code><code class="python functions">float</code><code class="python plain">(n)&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python value">100.</code><code class="python plain">)</code></div><div class="line number64 index63 alt1">&nbsp;</div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;根据有效NDVI筛选数据</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(ndvi_range[</code><code class="python value">1</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python value">100</code><code class="python plain">)</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(ndvi_range[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python value">100</code><code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fiteMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">eMax[nMin:nMax]</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fiteMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">eMin[nMin:nMax]</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fitndviSort&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ndviSort[nMin:nMax]</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fitMax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">linefit(fitndviSort,&nbsp;fiteMax)</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fitMin&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">linefit(fitndviSort,&nbsp;fiteMin)</code></div><div class="line number74 index73 alt1">&nbsp;</div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;作图</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">outfig&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">dir</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python plain">os.sep&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python string">'fig.png'</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">createPlot(fitndviSort,&nbsp;fiteMax,&nbsp;fiteMin,&nbsp;[fitMax,&nbsp;fitMin],&nbsp;outfig)</code></div><div class="line number78 index77 alt1">&nbsp;</div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">[fitMax,&nbsp;fitMin]</code></div></div></td></tr></tbody></table></div>
					<p>用到的一些函数，如计算线性拟合参数、作图等</p>
					<div id="highlighter_916815" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">linefit(x,&nbsp;y):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Linear&nbsp;fitting</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;x:</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;y:</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">N&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">float</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(x))</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sx,&nbsp;sy,&nbsp;sxx,&nbsp;syy,&nbsp;sxy&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">0</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">0</code><code class="python plain">,</code><code class="python functions">int</code><code class="python plain">(N)):</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sx&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">x[i]</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sy&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">y[i]</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sxx&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">x[i]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">x[i]</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">syy&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">y[i]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">y[i]</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sxy&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">x[i]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">y[i]</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">a&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(sy&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">sx&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">N&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">sxy)&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">(&nbsp;sx&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">sx&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">N&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">sxx)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(sy&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">a</code><code class="python keyword">*</code><code class="python plain">sx)</code><code class="python keyword">/</code><code class="python plain">N</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">abs</code><code class="python plain">(sy&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">sx&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">N&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">sxy)&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">math.sqrt((sxx&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">sx&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">sx&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">N)&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">(syy&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">sy&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">sy&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">N))</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">[a,&nbsp;b,&nbsp;r]</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">createPlot(ndvi,&nbsp;emax,&nbsp;emin,&nbsp;abcd,&nbsp;outfig):</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Create&nbsp;plot</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;ndvi:</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;emax:</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;emin:</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:param&nbsp;outfig:</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">:return:</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.rcParams[</code><code class="python string">'font.family'</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'Times&nbsp;New&nbsp;Roman'</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fig,&nbsp;ax&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">plt.subplots(figsize</code><code class="python keyword">=</code><code class="python plain">(</code><code class="python value">8</code><code class="python plain">,&nbsp;</code><code class="python value">5</code><code class="python plain">))</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.tick_params(labelsize</code><code class="python keyword">=</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ylimit_min&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.</code><code class="python functions">min</code><code class="python plain">(emin)&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">0.3</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">numpy.average(emin)</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ylimit_max&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.</code><code class="python functions">max</code><code class="python plain">(emax)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0.3</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">numpy.average(emax)</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.ylim(ylimit_min,&nbsp;ylimit_max)</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.xlim(</code><code class="python value">0</code><code class="python plain">,&nbsp;</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">cof&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.polyfit(ndvi,&nbsp;emax,&nbsp;</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">p&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.poly1d(cof)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.plot(ndvi,&nbsp;p(ndvi),&nbsp;label</code><code class="python keyword">=</code><code class="python string">'Dry&nbsp;edge&nbsp;fitting&nbsp;line'</code><code class="python plain">,&nbsp;linewidth</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">,&nbsp;c</code><code class="python keyword">=</code><code class="python string">'#555555'</code><code class="python plain">,&nbsp;linestyle</code><code class="python keyword">=</code><code class="python string">'--'</code><code class="python plain">)</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">cof&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.polyfit(ndvi,&nbsp;emin,&nbsp;</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">p&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">numpy.poly1d(cof)</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.plot(ndvi,&nbsp;p(ndvi),&nbsp;label</code><code class="python keyword">=</code><code class="python string">'Wet&nbsp;edge&nbsp;fitting&nbsp;line'</code><code class="python plain">,&nbsp;linewidth</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">,&nbsp;c</code><code class="python keyword">=</code><code class="python string">'#555555'</code><code class="python plain">,&nbsp;linestyle</code><code class="python keyword">=</code><code class="python string">'--'</code><code class="python plain">)</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.scatter(ndvi,&nbsp;emax,&nbsp;label</code><code class="python keyword">=</code><code class="python string">'Dry&nbsp;edge'</code><code class="python plain">,&nbsp;s</code><code class="python keyword">=</code><code class="python value">8</code><code class="python plain">,&nbsp;c</code><code class="python keyword">=</code><code class="python string">'#FF4500'</code><code class="python plain">)</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.scatter(ndvi,&nbsp;emin,&nbsp;label</code><code class="python keyword">=</code><code class="python string">'Wet&nbsp;edge'</code><code class="python plain">,&nbsp;s</code><code class="python keyword">=</code><code class="python value">8</code><code class="python plain">,&nbsp;c</code><code class="python keyword">=</code><code class="python string">'#1E90FF'</code><code class="python plain">)</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">a&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">b&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">c&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">d&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">1</code><code class="python plain">]</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(</code><code class="python value">0.05</code><code class="python plain">,&nbsp;ylimit_min&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">5</code><code class="python plain">,&nbsp;</code><code class="python string">"Dry&nbsp;edge:&nbsp;y&nbsp;=&nbsp;%.3fx&nbsp;+&nbsp;%.3f,&nbsp;r$^2$&nbsp;=&nbsp;%.3f"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(a,&nbsp;b,&nbsp;abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">0</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]),&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#FF4500'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python value">12</code><code class="python plain">)</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.text(</code><code class="python value">0.05</code><code class="python plain">,&nbsp;ylimit_min&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python string">"Wet&nbsp;edge:&nbsp;y&nbsp;=&nbsp;%.3fx&nbsp;+&nbsp;%.3f,&nbsp;r$^2$&nbsp;=&nbsp;%.3f"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(c,&nbsp;d,&nbsp;abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]&nbsp;</code><code class="python keyword">*</code>&nbsp;<code class="python plain">abcd[</code><code class="python value">1</code><code class="python plain">][</code><code class="python value">2</code><code class="python plain">]),&nbsp;color</code><code class="python keyword">=</code><code class="python string">'#1E90FF'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python value">12</code><code class="python plain">)</code></div><div class="line number57 index56 alt2">&nbsp;</div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.set_xlabel(</code><code class="python string">'NDVI'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.set_ylabel(</code><code class="python string">'LST&nbsp;($^o$c)'</code><code class="python plain">,&nbsp;fontsize</code><code class="python keyword">=</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.legend(fontsize</code><code class="python keyword">=</code><code class="python value">16</code><code class="python plain">,&nbsp;loc</code><code class="python keyword">=</code><code class="python string">'upper&nbsp;right'</code><code class="python plain">,&nbsp;ncol</code><code class="python keyword">=</code><code class="python value">2</code><code class="python plain">)</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ax.grid(</code><code class="python color1">True</code><code class="python plain">,&nbsp;linestyle</code><code class="python keyword">=</code><code class="python string">'--'</code><code class="python plain">,&nbsp;alpha</code><code class="python keyword">=</code><code class="python value">0.3</code><code class="python plain">)</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fig.tight_layout()</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.savefig(outfig,&nbsp;dpi</code><code class="python keyword">=</code><code class="python value">300</code><code class="python plain">)</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(</code><code class="python string">"\tSave&nbsp;as&nbsp;%s"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">outfig)</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plt.show()</code></div></div></td></tr></tbody></table></div>
					<p><b>应用方式</b></p>
					<div id="highlighter_670027" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">if</code>&nbsp;<code class="python plain">__name__&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">"__main__"</code><code class="python plain">:</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">##&nbsp;Define&nbsp;data&nbsp;path</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dataDir&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r</code><code class="python string">'&lt;data&nbsp;path&gt;'</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">##&nbsp;输入文件</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">NDVIfile&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dataDir&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">os.sep&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python string">'NDVI.tif'</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">LSTfile&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dataDir&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">os.sep&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python string">'LST.tif'</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">##&nbsp;有效NDVI</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ndvi_range&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[</code><code class="python value">0.2</code><code class="python plain">,&nbsp;</code><code class="python value">0.8</code><code class="python plain">]</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">##&nbsp;输出文件</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">outputfile&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dataDir&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">os.sep&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python string">'TVDI.tif'</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">calTVDI(dataDir,&nbsp;NDVIfile,&nbsp;LSTfile,&nbsp;ndvi_range,&nbsp;outputfile)</code></div></div></td></tr></tbody></table></div>
					<p>将上面几段代码粘贴在一个py文件中，设置文件路径，即可运行使用。</p>
					<p class="g-color-red">注意1：在计算干边、湿边过程中，会弹出matplotlib图形窗口，关闭后即可继续运行，图形保存在数据目录下。</p>
					<p>在使用过程中遇到问题，可在下方评论处留言~</p>
					<br>
					<p>Fighting, GISer!</p>
					<!-- Warning -->
					<div id="warning"></div>
					
				</div>
				<!-- Da shang -->
				<div id="dashang" class="dashang"></div>
				<!-- Comments -->
				<div id="comments"></div>
			</div>
			<div class="span2">
				<div class="block"></div>
				<div class="portlet" id="declareDiv"></div>
				<div class="block"></div>
				<div class="portlet">
					<p class="title"><i class="icon-book"></i><b>最新博文</b></p>
					<br>
					<div class="blog-page" id="blogs"></div>
				</div>
				<!-- Share -->
				<div id="shareit"></div>
			</div>
		</div>
	</div>
	<!-- others  --> 
	<div id="others"></div>
	<!-- footer  --> 
	<footer>
		<p id="copyright" class="copyright"></p>
	</footer>
    <!-- JavaScript -->
    <script src="../../../js/jquery.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
	<script src="../../../js/bloglist.js"></script>
	<script src="../../special/js/topicslist.js"></script>
	<script src="../../../js/paylist.js"></script>
	<script src="../blogsload.js"></script>
	<script src="../../../js/common.js"></script>
</body>
</html>
